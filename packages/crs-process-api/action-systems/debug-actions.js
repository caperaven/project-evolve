class E{static async perform(e,o,r,a){await this[e.action]?.(e,o,r,a)}static async start_monitor_events(e,o,r,a){const v=await crs.process.getValue(e.args.log,o,r,a),t=await crs.process.getValue((e.args.tag_name||"").toUpperCase(),o,r,a),d=await crs.process.getValue(e.args.event_name,o,r,a);globalThis.__monitoredEvents={events:[],addedCount:0,removedCount:0},EventTarget.prototype.addEventListenerBase=EventTarget.prototype.addEventListener,EventTarget.prototype.addEventListener=function(n,s){if(this.addEventListenerBase(n,s),t&&this.tagName!==t||d&&n!==d)return;const l=new Error().stack.split(`
`);v===!0&&console.log("Event added: ",{target:this,type:n,listener:s,trace:l}),globalThis.__monitoredEvents.addedCount++,globalThis.__monitoredEvents.events.push({target:this,type:n,listener:s,trace:l,path:m(this)})},EventTarget.prototype.removeEventListenerBase=EventTarget.prototype.removeEventListener,EventTarget.prototype.removeEventListener=function(n,s){if(this.removeEventListenerBase(n,s),t&&this.tagName!==t||d&&n!==d)return;const l=new Error().stack.split(`
`);v===!0&&console.log("Event removed: ",{target:this,type:n,listener:s,trace:l}),globalThis.__monitoredEvents.removedCount++,globalThis.__monitoredEvents.events=globalThis.__monitoredEvents.events.filter(g=>g.target!==this||g.type!==n||g.listener!==s)},console.log("Started monitoring events.")}static async stop_monitor_events(e,o,r,a){if(globalThis.__monitoredEvents===void 0){console.warn("No events are being monitored.");return}EventTarget.prototype.addEventListener=EventTarget.prototype.addEventListenerBase,EventTarget.prototype.removeEventListener=EventTarget.prototype.removeEventListenerBase,delete EventTarget.prototype.addEventListenerBase,delete EventTarget.prototype.removeEventListenerBase,globalThis.__monitoredEvents.addedCount>globalThis.__monitoredEvents.removedCount?console.warn(`The number of added events does not match the number of removed events. This may indicate a memory leak. Added: ${globalThis.__monitoredEvents.addedCount}, Removed: ${globalThis.__monitoredEvents.removedCount}`):console.log("No event leaks found");const v=globalThis.__monitoredEvents.events.map(t=>({target:[t.target.tagName,t.target.id||""].join("#"),type:t.type,path:t.path,trace:t.trace}));return console.table(globalThis.__monitoredEvents.events),globalThis.__monitoredEvents=null,delete globalThis.__monitoredEvents,e.args.target!=null&&await crs.process.setValue(e.args.target,v,o,r,a),v}}function m(i){if(!(i instanceof HTMLElement))return"";let e="";for(;i;)e=i.tagName+(e?">"+e:""),i=i.parentElement;return e}crs.intent.debug=E;export{E as DebugActions};

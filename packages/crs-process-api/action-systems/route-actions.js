import{RouteManager as p}from"./managers/router-manager.js";class f{static async perform(s,a,r,t){await this[s.action](s,a,r,t)}static async register(s,a,r,t){const e=await crs.process.getValue(s.args.definition,a,r,t),o=await crs.process.getValue(s.args.routes,a,r,t),l=await crs.process.getValue(s.args.callback,a,r,t),i=await crs.process.getValue(s.args.defaultView,a,r,t);globalThis.routeManager=new p(o,e,i,l)}static async dispose(s,a,r,t){globalThis.routeManager?.dispose(),delete globalThis.routeManager}static async parse(s,a,r,t){let e=await crs.process.getValue(s.args.url||window.location.href,a,r,t);e.indexOf("://")===-1&&(e=`http://${e}`);const o={params:{},query:{}},l=e.split("?")[1]?.split("&");e=e.split("?")[0];const i=e.split("/");o.protocol=i[0].replace(":",""),o.host=i[2];const g=globalThis.routeManager?.definition?.parameters;for(let n=3;n<i.length;n++){const u=n-3,c=g?.[u]??u;o.params[c]=i[n]}if(l)for(const n of l){const u=n.split("=")[0],c=n.split("=")[1];o.query[u]=c}return o}static async create_url(s,a,r,t){const e=await crs.process.getValue(s.args.definition,a,r,t);if(e==null)return;const o=[e.protocol||"http","://"].join(""),l=e.host,i=[],g=[];if(e.params)for(const c in e.params)i.push(e.params[c]);if(e.query)for(const c in e.query)g.push([`${c}=${e.query[c]}`]);const n=i.join("/"),u=g.length===0?"":`?${g.join("&")}`;return`${o}${l}/${n}${u}`}static async goto(s,a,r,t){await globalThis.routeManager?.goto(s.args.definition)}static async refresh(s,a,r,t){await globalThis.routeManager?.refresh()}static async set_parameters(s,a,r,t){const e=await crs.process.getValue(s.args.parameters,a,r,t);if(e==null)return;const o=await crs.process.getValue(s.args.refresh||!1,a,r,t);globalThis.routeManager.setParameters(e),o&&await globalThis.routeManager.refresh()}static async set_queries(s,a,r,t){const e=await crs.process.getValue(s.args.queries,a,r,t);if(e==null)return;const o=await crs.process.getValue(s.args.refresh||!1,a,r,t);globalThis.routeManager?.setQueries(e),o&&await globalThis.routeManager.refresh()}}crs.intent.route=f;export{f as RouteActions};

import"./../../action-systems/route-actions.js";class l extends HTMLElement{#i;#n=this.#l.bind(this);#s=this.#a.bind(this);#e="";#t;async connectedCallback(){document.querySelector("nav").addEventListener("click",this.#s);const t=this.dataset.routes,e=await fetch(t).then(i=>i.json());this.#i=e.root||"app",await crs.call("route","register",{routes:e.routes,definition:e.definition,defaultView:e.default,callback:this.#n})}async disconnectedCallback(){document.querySelector("nav").removeEventListener("click",this.#s),await crs.call("route","unregister",{}),this.#i=null,this.#n=null,this.#s=null,this.#e=null,this.#t=null}async#l(t,e){let i=t.params.view;i!==this.#e?(this.#t?.remove(),this.#e=i,this.#t=await a(this.#i,this.#e),(this.querySelector("main")||this).appendChild(this.#t)):this.#t.routeChanged?.(t),this.#t.setProperty("title",e)}async#a(t){const e=t.composedPath()[0].closest("a");e&&e.href.startsWith(window.location.origin)&&(t.preventDefault(),await crs.call("route","goto",{definition:e.href}))}}async function a(n,t){const i=await import(`/${n}/${t}/${t}.js`),s=`${t}-view`;return customElements.get(s)==null&&customElements.define(s,i.default),document.createElement(s)}customElements.define("view-loader",l);
